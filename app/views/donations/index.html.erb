<div class="row wrapper border-bottom white-bg page-heading">
<% content_for :title, "Donations - #{current_organization.name}" %>
  <div class="col-lg-8">
    <h2>Donations for <%= current_organization.name %></h2>
    <ol class="breadcrumb">
      <li class="breadcrumb-item">
        <%= link_to(dashboard_path) do %>
          <i class="fa fa-dashboard"></i> Home
        <% end %>
      </li>
      <li class="breadcrumb-item active">
        All Donations
      </li>
    </ol>
  </div>
  <div class="col-lg-4">
    <div class="title-action">
      <%= download_button_to(csv_path(format: :csv, type: "Donation"), { text: "Export Donations", size: "lg" }) if @donations.any? %>
      <%= new_button_to new_donation_path(organization_id: current_organization), { text: "New Donation" } %>
    </div>
  </div>
</div>

<!-- Main content -->
<div class="row">
  <div class="col-lg-12">
    <div class="wrapper wrapper-content animated fadeInRight">
      <div class="ibox-content p-xl">
        <div class="row">
          <section id="filters">
            <%= form_tag(donations_path, method: :get) do |f| %>
            <div class="row">
              <% if @storage_locations.present? %>
                <div class="form-control col-lg-3 col-md-4 col-sm-6 col-xs-12">
                  <%= label_tag "by Storage Location" %>
                  <%= collection_select(:filters, :at_storage_location, @storage_locations || {}, :id, :name, { include_blank: true, selected: @selected_storage_location }, class: "form-control") %>
                </div>
              <% end %>
              <% if @sources.present? %>
                <div class="form-control col-lg-3 col-md-4 col-sm-6 col-xs-12">
                  <%= label_tag "by Source" %>
                  <%= select_tag "filters[by_source]", options_for_select(@sources, @selected_source), { include_blank: true, class: "form-control" } %>
                </div>
              <% end %>
              <% if @diaper_drives.present? %>
                <div class="form-control col-lg-3 col-md-4 col-sm-6 col-xs-12">
                  <%= label_tag "by Diaper Drive" %>
                  <%= collection_select(:filters, :by_diaper_drive_participant, @diaper_drives || {}, :id, :business_name, { include_blank: true, selected: @selected_diaper_drive }, class: "form-control") %>
                </div>
              <% end %>
              <% if @donation_sites.present? %>
                <div class="form-control col-lg-3 col-md-4 col-sm-6 col-xs-12">
                  <%= label_tag "by Donation Site" %>
                  <%= collection_select(:filters, :from_donation_site, @donation_sites || {}, :id, :name, { include_blank: true, selected: @selected_donation_site }, class: "form-control") %>
                </div>
              <% end %>
              <div class="form-control col-lg-3 col-md-4 col-sm-6 col-xs-12">
                <%= label_tag "by Date" %>
                <%= date_select :date_filters, :issued_at, order: [:month,  :year], include_blank: true, selected: @selected_date %>
              </div>
            </div><!-- /.row -->
            <div class="row">
              <div class="col-xs-12">
                <%= filter_button %>
                <%= cancel_button_to donations_path %>
              </div>
            </div><!-- /.row -->
            <% end # form %>
          </section><!-- /#filters -->
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>Source</th>
                  <th>Date</th>
                  <th>Donation Site</th>
                  <th>Storage Location</th>
                  <th>Quantity of Items</th>
                  <th>Variety of Items</th>
                  <th>In Kind Value</th>
                  <th>&nbsp;</th>
                </tr>
              </thead>
              <tbody>
                <%= render partial: "donation_row", collection: @donations %>
                <tr>
                  <td><strong>Total</strong></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td><strong><%= @donations_quantity %></strong></td>
                  <td></td>
                  <td><strong><%= item_value(@total_value_all_donations) %></strong></td>
                  <td></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
